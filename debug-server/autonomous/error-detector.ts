import { exec } from 'child_process';
import { promisify } from 'util';
import fs from 'fs/promises';

const execAsync = promisify(exec);

export interface –û–ø—Ä–µ–¥–µ–ª—è—Ç–æ—Ä–û—à–∏–±–æ–∫ {
  —Ç–∏–ø–û—à–∏–±–∫–∏: '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è' | '–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ' | '–∏–Ω—Ñ–æ';
  –æ–±–ª–∞—Å—Ç—å: 'performance' | 'javascript' | 'network' | 'ui' | 'memory' | 'security';
  –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: boolean;
  —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –°–ø–æ—Å–æ–±–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è[];
  –æ–ø–∏—Å–∞–Ω–∏–µ: string;
  —Å–∏–º–ø—Ç–æ–º—ã: string[];
}

export interface –°–ø–æ—Å–æ–±–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è {
  –Ω–∞–∑–≤–∞–Ω–∏–µ: string;
  –∫–æ–º–∞–Ω–¥–∞: string;
  –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: number; // 0-100%
  –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è' | '—Å—Ä–µ–¥–Ω—è—è' | '–Ω–∏–∑–∫–∞—è';
  –æ–ø–∏—Å–∞–Ω–∏–µ: string;
}

interface –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞ {
  id: string;
  —Ç–∏–ø: string;
  –æ–ø–∏—Å–∞–Ω–∏–µ: string;
  –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: '–Ω–∏–∑–∫–∞—è' | '—Å—Ä–µ–¥–Ω—è—è' | '–≤—ã—Å–æ–∫–∞—è' | '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è';
  timestamp: Date;
  –ø–æ–ø—ã—Ç–∫–∏–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: number;
  –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞: boolean;
}

export class –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π–ú–æ–Ω–∏—Ç–æ—Ä {
  private —Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫: Map<string, –û–ø—Ä–µ–¥–µ–ª—è—Ç–æ—Ä–û—à–∏–±–æ–∫> = new Map();
  private –∞–∫—Ç–∏–≤–Ω—ã–µ–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: Map<string, Promise<boolean>> = new Map();
  private –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ–ü—Ä–æ–±–ª–µ–º—ã: Map<string, –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞> = new Map();
  private –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–ê–∫—Ç–∏–≤–µ–Ω: boolean = false;
  private –∏–Ω—Ç–µ—Ä–≤–∞–ª–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞?: NodeJS.Timeout;
  private –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π: {
    onErrorDetected?: (error: –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞) => void;
    onAutoFixAttempt?: (attempt: any) => void;
  } = {};

  constructor() {
    this.–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª–∏–û—à–∏–±–æ–∫();
  }

  private –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª–∏–û—à–∏–±–æ–∫(): void {
    // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.set('memory-leak', {
      —Ç–∏–ø–û—à–∏–±–∫–∏: '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è',
      –æ–±–ª–∞—Å—Ç—å: 'memory',
      –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: true,
      –æ–ø–∏—Å–∞–Ω–∏–µ: '–£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏',
      —Å–∏–º–ø—Ç–æ–º—ã: ['–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–æ—Å—Ç –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏', '–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã', '–ö—Ä–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'],
      —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: [
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏',
          –∫–æ–º–∞–Ω–¥–∞: 'gc-force',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 70,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ó–∞–ø—É—Å–∫ —Å–±–æ—Ä—â–∏–∫–∞ –º—É—Å–æ—Ä–∞'
        },
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
          –∫–æ–º–∞–Ω–¥–∞: 'restart-app',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 95,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '—Å—Ä–µ–¥–Ω—è—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'
        }
      ]
    });

    this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.set('high-cpu-usage', {
      —Ç–∏–ø–û—à–∏–±–∫–∏: '–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ',
      –æ–±–ª–∞—Å—Ç—å: 'performance',
      –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: true,
      –æ–ø–∏—Å–∞–Ω–∏–µ: '–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU',
      —Å–∏–º–ø—Ç–æ–º—ã: ['CPU > 80%', '–ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å', '–ì–æ—Ä—è—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏'],
      —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: [
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
          –∫–æ–º–∞–Ω–¥–∞: 'optimize-processes',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 60,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤'
        }
      ]
    });

    this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.set('network-errors', {
      —Ç–∏–ø–û—à–∏–±–∫–∏: '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è',
      –æ–±–ª–∞—Å—Ç—å: 'network',
      –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: true,
      –æ–ø–∏—Å–∞–Ω–∏–µ: '–ß–∞—Å—Ç—ã–µ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏',
      —Å–∏–º–ø—Ç–æ–º—ã: ['Timeout –∑–∞–ø—Ä–æ—Å–æ–≤', '5xx –æ—à–∏–±–∫–∏', '–ü–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è'],
      —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: [
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞',
          –∫–æ–º–∞–Ω–¥–∞: 'restart-network',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 80,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '—Å—Ä–µ–¥–Ω—è—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π'
        },
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä',
          –∫–æ–º–∞–Ω–¥–∞: 'switch-to-backup',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 90,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä'
        }
      ]
    });

    this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.set('javascript-errors', {
      —Ç–∏–ø–û—à–∏–±–∫–∏: '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è',
      –æ–±–ª–∞—Å—Ç—å: 'javascript',
      –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: true,
      –æ–ø–∏—Å–∞–Ω–∏–µ: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ JavaScript –æ—à–∏–±–∫–∏',
      —Å–∏–º–ø—Ç–æ–º—ã: ['Uncaught exceptions', '–°–±–æ–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤', '–ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω'],
      —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: [
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞',
          –∫–æ–º–∞–Ω–¥–∞: 'reload-component',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 70,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞'
        },
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏',
          –∫–æ–º–∞–Ω–¥–∞: 'rollback-version',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 85,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '—Å—Ä–µ–¥–Ω—è—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–û—Ç–∫–∞—Ç –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏'
        }
      ]
    });

    this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.set('build-errors', {
      —Ç–∏–ø–û—à–∏–±–∫–∏: '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è',
      –æ–±–ª–∞—Å—Ç—å: 'javascript',
      –∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞: true,
      –æ–ø–∏—Å–∞–Ω–∏–µ: '–û—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
      —Å–∏–º–ø—Ç–æ–º—ã: ['Build failed', 'TypeScript errors', 'Module not found'],
      —Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: [
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞',
          –∫–æ–º–∞–Ω–¥–∞: 'clean-rebuild',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 75,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '–≤—ã—Å–æ–∫–∞—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞'
        },
        {
          –Ω–∞–∑–≤–∞–Ω–∏–µ: '–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π',
          –∫–æ–º–∞–Ω–¥–∞: 'reinstall-deps',
          –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞: 80,
          –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: '—Å—Ä–µ–¥–Ω—è—è',
          –æ–ø–∏—Å–∞–Ω–∏–µ: '–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ node_modules'
        }
      ]
    });

    console.log(`ü§ñ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ${this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.size} –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª–µ–π –æ—à–∏–±–æ–∫`);
  }

  public async –Ω–∞—á–∞—Ç—å–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥(): Promise<void> {
    if (this.–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–ê–∫—Ç–∏–≤–µ–Ω) {
      console.log('‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω');
      return;
    }

    this.–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–ê–∫—Ç–∏–≤–µ–Ω = true;
    console.log('ü§ñ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞...');

    // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º
    this.–∏–Ω—Ç–µ—Ä–≤–∞–ª–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ = setInterval(async () => {
      try {
        await this.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å();
        await this.–ø—Ä–æ–≤–µ—Ä–∏—Ç—åJavaScript–û—à–∏–±–∫–∏();
        await this.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å–°–µ—Ç–µ–≤—ã–µ–ü—Ä–æ–±–ª–µ–º—ã();
        await this.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å();
        await this.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ü–∞–º—è—Ç—å();
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:', error);
      }
    }, 5000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥

    console.log('‚úÖ –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω');
  }

  public async –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥(): Promise<void> {
    this.–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–ê–∫—Ç–∏–≤–µ–Ω = false;
    
    if (this.–∏–Ω—Ç–µ—Ä–≤–∞–ª–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞) {
      clearInterval(this.–∏–Ω—Ç–µ—Ä–≤–∞–ª–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞);
      this.–∏–Ω—Ç–µ—Ä–≤–∞–ª–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ = undefined;
    }

    console.log('‚èπÔ∏è –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
  }

  private async –ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å(): Promise<void> {
    try {
      const memoryUsage = process.memoryUsage();
      const cpuUsage = process.cpuUsage();

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
      if (memoryUsage.heapUsed > 512 * 1024 * 1024) { // 512MB
        await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('memory-leak', 
          `–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: ${Math.round(memoryUsage.heapUsed / 1024 / 1024)}MB`);
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU
      const cpuPercent = (cpuUsage.user + cpuUsage.system) / 1000000; // –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ
      if (cpuPercent > 80) {
        await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('high-cpu-usage', 
          `–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU: ${cpuPercent.toFixed(1)}%`);
      }

    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:', error);
    }
  }

  private async –ø—Ä–æ–≤–µ—Ä–∏—Ç—åJavaScript–û—à–∏–±–∫–∏(): Promise<void> {
    try {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ JavaScript –æ—à–∏–±–æ–∫
      // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
      
      // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
      const errorCount = await this.–ø–æ–¥—Å—á–∏—Ç–∞—Ç—å–û—à–∏–±–∫–∏–ó–∞–ü–æ—Å–ª–µ–¥–Ω–∏–µ–ú–∏–Ω—É—Ç—ã(5);
      
      if (errorCount > 10) {
        await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('javascript-errors', 
          `–ú–Ω–æ–≥–æ JavaScript –æ—à–∏–±–æ–∫: ${errorCount} –∑–∞ 5 –º–∏–Ω—É—Ç`);
      }
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ JavaScript:', error);
    }
  }

  private async –ø—Ä–æ–≤–µ—Ä–∏—Ç—å–°–µ—Ç–µ–≤—ã–µ–ü—Ä–æ–±–ª–µ–º—ã(): Promise<void> {
    try {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
      const endpoints = ['http://localhost:5173', 'http://localhost:3001'];
      
      for (const endpoint of endpoints) {
        try {
          const response = await fetch(endpoint, { 
            method: 'HEAD',
            timeout: 3000 
          } as any);
          
          if (!response.ok) {
            await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('network-errors', 
              `–≠–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${endpoint} (${response.status})`);
          }
        } catch (error) {
          await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('network-errors', 
            `–≠–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${endpoint} (${error.message})`);
        }
      }
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ç–∏:', error);
    }
  }

  private async –ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å(): Promise<void> {
    try {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —á–µ—Ä–µ–∑ headless –±—Ä–∞—É–∑–µ—Ä
      // –í –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Playwright
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:', error);
    }
  }

  private async –ø—Ä–æ–≤–µ—Ä–∏—Ç—å–ü–∞–º—è—Ç—å(): Promise<void> {
    try {
      const memUsage = process.memoryUsage();
      const memoryLeakThreshold = 1024 * 1024 * 1024; // 1GB
      
      if (memUsage.rss > memoryLeakThreshold) {
        await this.–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É('memory-leak', 
          `–í–æ–∑–º–æ–∂–Ω–∞—è —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏: RSS ${Math.round(memUsage.rss / 1024 / 1024)}MB`);
      }
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞–º—è—Ç–∏:', error);
    }
  }

  private async –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å–ü—Ä–æ–±–ª–µ–º—É(—Ç–∏–ø–ü—Ä–æ–±–ª–µ–º—ã: string, –æ–ø–∏—Å–∞–Ω–∏–µ: string): Promise<void> {
    const –ø—Ä–æ–±–ª–µ–º–∞Id = `${—Ç–∏–ø–ü—Ä–æ–±–ª–µ–º—ã}-${Date.now()}`;
    
    if (this.–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ–ü—Ä–æ–±–ª–µ–º—ã.has(–ø—Ä–æ–±–ª–µ–º–∞Id)) {
      return; // –ü—Ä–æ–±–ª–µ–º–∞ —É–∂–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞
    }

    const –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å = this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.get(—Ç–∏–ø–ü—Ä–æ–±–ª–µ–º—ã);
    if (!–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å) {
      console.warn(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã: ${—Ç–∏–ø–ü—Ä–æ–±–ª–µ–º—ã}`);
      return;
    }

    const –ø—Ä–æ–±–ª–µ–º–∞: –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞ = {
      id: –ø—Ä–æ–±–ª–µ–º–∞Id,
      —Ç–∏–ø: —Ç–∏–ø–ü—Ä–æ–±–ª–µ–º—ã,
      –æ–ø–∏—Å–∞–Ω–∏–µ,
      –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: this.–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å(–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å.—Ç–∏–ø–û—à–∏–±–∫–∏),
      timestamp: new Date(),
      –ø–æ–ø—ã—Ç–∫–∏–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: 0,
      –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞: false
    };

    this.–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ–ü—Ä–æ–±–ª–µ–º—ã.set(–ø—Ä–æ–±–ª–µ–º–∞Id, –ø—Ä–æ–±–ª–µ–º–∞);

    console.log(`üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: ${–ø—Ä–æ–±–ª–µ–º–∞.–æ–ø–∏—Å–∞–Ω–∏–µ}`);

    // –£–≤–µ–¥–æ–º–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª–µ–π
    if (this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onErrorDetected) {
      this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onErrorDetected(–ø—Ä–æ–±–ª–µ–º–∞);
    }

    // –ü—ã—Ç–∞–µ–º—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
    if (–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å.–∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞) {
      await this.–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–ò—Å–ø—Ä–∞–≤–∏—Ç—å(–ø—Ä–æ–±–ª–µ–º–∞, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å);
    }
  }

  public async –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–ò—Å–ø—Ä–∞–≤–∏—Ç—å(
    –ø—Ä–æ–±–ª–µ–º–∞: –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞, 
    –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å: –û–ø—Ä–µ–¥–µ–ª—è—Ç–æ—Ä–û—à–∏–±–æ–∫
  ): Promise<boolean> {
    if (!–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å.–∞–≤—Ç–æ–ò—Å–ø—Ä–∞–≤–∏–º–∞) {
      console.log(`‚ùå –ü—Ä–æ–±–ª–µ–º–∞ ${–ø—Ä–æ–±–ª–µ–º–∞.—Ç–∏–ø} –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏`);
      return false;
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    if (this.–∞–∫—Ç–∏–≤–Ω—ã–µ–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.has(–ø—Ä–æ–±–ª–µ–º–∞.id)) {
      console.log(`‚è≥ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ${–ø—Ä–æ–±–ª–µ–º–∞.id} —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è`);
      return false;
    }

    console.log(`üîß –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${–ø—Ä–æ–±–ª–µ–º–∞.–æ–ø–∏—Å–∞–Ω–∏–µ}`);

    // –í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ —Å–ø–æ—Å–æ–±–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    const –ª—É—á—à–∏–π–°–ø–æ—Å–æ–± = –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å.—Å–ø–æ—Å–æ–±—ã–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      .filter(—Å–ø–æ—Å–æ–± => —Å–ø–æ—Å–æ–±.–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å === '–≤—ã—Å–æ–∫–∞—è')
      .sort((a, b) => b.–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞ - a.–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å–£—Å–ø–µ—Ö–∞)[0];

    if (!–ª—É—á—à–∏–π–°–ø–æ—Å–æ–±) {
      console.log(`‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è ${–ø—Ä–æ–±–ª–µ–º–∞.—Ç–∏–ø}`);
      return false;
    }

    const –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µPromise = this.–≤—ã–ø–æ–ª–Ω–∏—Ç—å–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ(–ø—Ä–æ–±–ª–µ–º–∞, –ª—É—á—à–∏–π–°–ø–æ—Å–æ–±);
    this.–∞–∫—Ç–∏–≤–Ω—ã–µ–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.set(–ø—Ä–æ–±–ª–µ–º–∞.id, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µPromise);

    try {
      const —Ä–µ–∑—É–ª—å—Ç–∞—Ç = await –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µPromise;
      
      –ø—Ä–æ–±–ª–µ–º–∞.–ø–æ–ø—ã—Ç–∫–∏–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è++;
      
      if (—Ä–µ–∑—É–ª—å—Ç–∞—Ç) {
        –ø—Ä–æ–±–ª–µ–º–∞.–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ = true;
        console.log(`‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ ${–ø—Ä–æ–±–ª–µ–º–∞.–æ–ø–∏—Å–∞–Ω–∏–µ} —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞`);
      } else {
        console.log(`‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É ${–ø—Ä–æ–±–ª–µ–º–∞.–æ–ø–∏—Å–∞–Ω–∏–µ}`);
      }

      return —Ä–µ–∑—É–ª—å—Ç–∞—Ç;
      
    } finally {
      this.–∞–∫—Ç–∏–≤–Ω—ã–µ–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.delete(–ø—Ä–æ–±–ª–µ–º–∞.id);
    }
  }

  private async –≤—ã–ø–æ–ª–Ω–∏—Ç—å–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ(
    –ø—Ä–æ–±–ª–µ–º–∞: –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞, 
    —Å–ø–æ—Å–æ–±: –°–ø–æ—Å–æ–±–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  ): Promise<boolean> {
    
    console.log(`üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: ${—Å–ø–æ—Å–æ–±.–Ω–∞–∑–≤–∞–Ω–∏–µ} –¥–ª—è ${–ø—Ä–æ–±–ª–µ–º–∞.—Ç–∏–ø}`);

    // –£–≤–µ–¥–æ–º–ª—è–µ–º –æ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    if (this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onAutoFixAttempt) {
      this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onAutoFixAttempt({
        –ø—Ä–æ–±–ª–µ–º–∞,
        —Å–ø–æ—Å–æ–±,
        timestamp: new Date()
      });
    }

    try {
      switch (—Å–ø–æ—Å–æ–±.–∫–æ–º–∞–Ω–¥–∞) {
        case 'gc-force':
          return await this.–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è–û—á–∏—Å—Ç–∫–∞–ü–∞–º—è—Ç–∏();
          
        case 'restart-app':
          return await this.–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ();
          
        case 'clean-rebuild':
          return await this.–æ—á–∏—Å—Ç–∏—Ç—å–ò–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å();
          
        case 'reinstall-deps':
          return await this.–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏();
          
        case 'restart-network':
          return await this.–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å–°–µ—Ç—å();
          
        default:
          console.warn(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${—Å–ø–æ—Å–æ–±.–∫–æ–º–∞–Ω–¥–∞}`);
          return false;
      }
      
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ${—Å–ø–æ—Å–æ–±.–Ω–∞–∑–≤–∞–Ω–∏–µ}:`, error);
      return false;
    }
  }

  private async –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è–û—á–∏—Å—Ç–∫–∞–ü–∞–º—è—Ç–∏(): Promise<boolean> {
    try {
      if (global.gc) {
        global.gc();
        console.log('üßπ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞');
        return true;
      } else {
        console.warn('‚ö†Ô∏è global.gc –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
        return false;
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏:', error);
      return false;
    }
  }

  private async –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ(): Promise<boolean> {
    try {
      console.log('üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
      // –í production –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
      // process.exit(0); // –ë—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
      return true;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
      return false;
    }
  }

  private async –æ—á–∏—Å—Ç–∏—Ç—å–ò–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å(): Promise<boolean> {
    try {
      console.log('üî® –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞...');
      
      // –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
      await execAsync('npm run build:dev');
      
      console.log('‚úÖ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
      return true;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏:', error);
      return false;
    }
  }

  private async –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏(): Promise<boolean> {
    try {
      console.log('üì¶ –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...');
      
      await execAsync('rm -rf node_modules package-lock.json');
      await execAsync('npm install');
      
      console.log('‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
      return true;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:', error);
      return false;
    }
  }

  private async –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å–°–µ—Ç—å(): Promise<boolean> {
    try {
      console.log('üåê –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π...');
      // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
      return true;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ç–∏:', error);
      return false;
    }
  }

  private –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å(—Ç–∏–ø–û—à–∏–±–∫–∏: string): '–Ω–∏–∑–∫–∞—è' | '—Å—Ä–µ–¥–Ω—è—è' | '–≤—ã—Å–æ–∫–∞—è' | '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è' {
    switch (—Ç–∏–ø–û—à–∏–±–∫–∏) {
      case '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è': return '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è';
      case '–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ': return '–≤—ã—Å–æ–∫–∞—è';
      case '–∏–Ω—Ñ–æ': return '—Å—Ä–µ–¥–Ω—è—è';
      default: return '–Ω–∏–∑–∫–∞—è';
    }
  }

  private async –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å–û—à–∏–±–∫–∏–ó–∞–ü–æ—Å–ª–µ–¥–Ω–∏–µ–ú–∏–Ω—É—Ç—ã(–º–∏–Ω—É—Ç—ã: number): Promise<number> {
    // –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–∏—Å—Ç–µ–º–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    return Math.floor(Math.random() * 5); // –°–∏–º—É–ª—è—Ü–∏—è
  }

  // –ú–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
  public onErrorDetected(callback: (error: –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è–ü—Ä–æ–±–ª–µ–º–∞) => void): void {
    this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onErrorDetected = callback;
  }

  public onAutoFixAttempt(callback: (attempt: any) => void): void {
    this.–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏–°–æ–±—ã—Ç–∏–π.onAutoFixAttempt = callback;
  }

  public –ø–æ–ª—É—á–∏—Ç—å–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É(): any {
    const –≤—Å–µ–ü—Ä–æ–±–ª–µ–º—ã = Array.from(this.–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ–ü—Ä–æ–±–ª–µ–º—ã.values());
    
    return {
      –≤—Å–µ–≥–æ–ü—Ä–æ–±–ª–µ–º: –≤—Å–µ–ü—Ä–æ–±–ª–µ–º—ã.length,
      –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö–ü—Ä–æ–±–ª–µ–º: –≤—Å–µ–ü—Ä–æ–±–ª–µ–º—ã.filter(p => p.–∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å === '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è').length,
      –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö–ü—Ä–æ–±–ª–µ–º: –≤—Å–µ–ü—Ä–æ–±–ª–µ–º—ã.filter(p => p.–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞).length,
      –∞–∫—Ç–∏–≤–Ω—ã—Ö–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: this.–∞–∫—Ç–∏–≤–Ω—ã–µ–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.size,
      –¥–æ—Å—Ç—É–ø–Ω—ã—Ö–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª–µ–π: this.—Å–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.size
    };
  }
}