<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏–≥—Ä—ã</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #333;
            background: #87CEEB;
            display: block;
            margin: 20px auto;
        }
        .info {
            text-align: center;
            margin: 20px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="info">
        <h1>üö¥‚Äç‚ôÇÔ∏è –¢–µ—Å—Ç –∏–≥—Ä—ã –í–µ–ª–æ—Å–∏–ø–µ–¥–Ω—ã–µ –≥–æ–Ω–∫–∏</h1>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É Canvas –∏ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏</p>
        <button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <button onclick="stopGame()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–≥—Ä—É</button>
        <button onclick="jump()">–ü—Ä—ã–∂–æ–∫</button>
    </div>
    
    <canvas id="gameCanvas" width="800" height="400"></canvas>
    
    <div class="status">
        <div id="gameStatus">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
        <div id="score">–û—á–∫–∏: 0</div>
        <div id="time">–í—Ä–µ–º—è: 30s</div>
        <div id="combo">–ö–æ–º–±–æ: 0x</div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameState = {
            isPlaying: false,
            score: 0,
            timeLeft: 30,
            combo: 0,
            bikeY: 300,
            bikeX: 100,
            obstacles: [],
            gameLoop: null,
            obstacleSpawn: null
        };

        function drawBackground() {
            // –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–µ –Ω–µ–±–æ
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 800, 400);

            // –û–±–ª–∞–∫–∞
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.beginPath();
            ctx.arc(100, 80, 30, 0, Math.PI * 2);
            ctx.arc(130, 80, 25, 0, Math.PI * 2);
            ctx.arc(160, 80, 30, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawGround() {
            // –ó–µ–º–ª—è
            ctx.fillStyle = '#8FBC8F';
            ctx.fillRect(0, 300, 800, 100);
            
            // –î–æ—Ä–æ–≥–∞
            ctx.fillStyle = '#696969';
            ctx.fillRect(0, 320, 800, 60);
            
            // –†–∞–∑–º–µ—Ç–∫–∞ –¥–æ—Ä–æ–≥–∏
            ctx.strokeStyle = '#FFFFFF';
            ctx.setLineDash([20, 20]);
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, 350);
            ctx.lineTo(800, 350);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function drawBike(x, y) {
            // –†–∞–º–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
            ctx.strokeStyle = '#E74C3C';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + 40, y);
            ctx.lineTo(x + 20, y - 20);
            ctx.lineTo(x, y);
            ctx.stroke();
            
            // –ö–æ–ª–µ—Å–∞
            ctx.strokeStyle = '#2C3E50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(x + 10, y + 10, 12, 0, Math.PI * 2);
            ctx.arc(x + 30, y + 10, 12, 0, Math.PI * 2);
            ctx.stroke();
        }

        function drawObstacle(obstacle) {
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(obstacle.type, obstacle.x, obstacle.y + obstacle.height + 15);
        }

        function drawUI() {
            // –§–æ–Ω –¥–ª—è UI
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(10, 10, 200, 100);
            
            // –¢–µ–∫—Å—Ç UI
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '16px Arial';
            ctx.fillText(`–û—á–∫–∏: ${gameState.score}`, 20, 30);
            ctx.fillText(`–í—Ä–µ–º—è: ${gameState.timeLeft}s`, 20, 50);
            ctx.fillText(`–ö–æ–º–±–æ: ${gameState.combo}x`, 20, 70);
            ctx.fillText(`–£—Ä–æ–≤–µ–Ω—å: ${Math.floor(gameState.score / 200) + 1}`, 20, 90);
        }

        function gameLoop() {
            if (!gameState.isPlaying) return;

            // –û—á–∏—Å—Ç–∫–∞ canvas
            ctx.clearRect(0, 0, 800, 400);

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
            drawBackground();
            drawGround();
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            gameState.obstacles.forEach(obstacle => {
                drawObstacle(obstacle);
            });
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
            drawBike(gameState.bikeX, gameState.bikeY);
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ UI
            drawUI();

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            gameState.obstacles = gameState.obstacles
                .map(obstacle => ({
                    ...obstacle,
                    x: obstacle.x - 3
                }))
                .filter(obstacle => obstacle.x > -obstacle.width);

            // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            gameState.gameLoop = requestAnimationFrame(gameLoop);
        }

        function spawnObstacles() {
            if (!gameState.isPlaying) return;

            const types = ['–ü—Ä–æ–µ–∫—Ç–æ—Ä', '–ü–∞–Ω–µ–ª—å', '–ö–æ–º–ø—å—é—Ç–µ—Ä', '–ö–æ–ª–æ–Ω–∫–∞', '–ö–∞–º–µ—Ä–∞'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            const newObstacle = {
                x: 800,
                y: 300 - 40,
                width: 40,
                height: 40,
                type: type
            };
            
            gameState.obstacles.push(newObstacle);
            
            // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å–ø–∞–≤–Ω
            gameState.obstacleSpawn = setTimeout(spawnObstacles, 2000);
        }

        function startGame() {
            console.log('Starting game...');
            gameState.isPlaying = true;
            gameState.score = 0;
            gameState.timeLeft = 30;
            gameState.combo = 0;
            gameState.obstacles = [];
            
            document.getElementById('gameStatus').textContent = '–°—Ç–∞—Ç—É—Å: –ò–≥—Ä–∞ –∏–¥–µ—Ç!';
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            gameLoop();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ø–∞–≤–Ω –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            spawnObstacles();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            const timer = setInterval(() => {
                gameState.timeLeft--;
                document.getElementById('time').textContent = `–í—Ä–µ–º—è: ${gameState.timeLeft}s`;
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(timer);
                    stopGame();
                }
            }, 1000);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            const scoreTimer = setInterval(() => {
                if (gameState.isPlaying) {
                    gameState.score++;
                    gameState.combo++;
                    document.getElementById('score').textContent = `–û—á–∫–∏: ${gameState.score}`;
                    document.getElementById('combo').textContent = `–ö–æ–º–±–æ: ${gameState.combo}x`;
                } else {
                    clearInterval(scoreTimer);
                }
            }, 1000);
        }

        function stopGame() {
            console.log('Stopping game...');
            gameState.isPlaying = false;
            
            if (gameState.gameLoop) {
                cancelAnimationFrame(gameState.gameLoop);
            }
            if (gameState.obstacleSpawn) {
                clearTimeout(gameState.obstacleSpawn);
            }
            
            document.getElementById('gameStatus').textContent = '–°—Ç–∞—Ç—É—Å: –ò–≥—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞';
        }

        function jump() {
            if (!gameState.isPlaying) return;
            
            console.log('Jump!');
            gameState.bikeY = 200; // –ü—Ä—ã–∂–æ–∫
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –∑–µ–º–ª—é —á–µ—Ä–µ–∑ 500–º—Å
            setTimeout(() => {
                gameState.bikeY = 300;
            }, 500);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            console.log('Game test page loaded');
            drawBackground();
            drawGround();
            drawBike(100, 300);
            drawUI();
        };
    </script>
</body>
</html>
