<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∞–π—Ç–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .status {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .warning { border-left: 4px solid #ff9800; }
        .info { border-left: 4px solid #2196F3; }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976D2; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∞–π—Ç–∞ WeShow</h1>
    
    <div class="status info">
        <h3>üìä –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞</h3>
        <p id="server-status">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</p>
    </div>

    <div class="status info">
        <h3>üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π</h3>
        <button onclick="testMainSite()">–¢–µ—Å—Ç –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</button>
        <button onclick="testAdminPanel()">–¢–µ—Å—Ç –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏</button>
        <button onclick="testSupabase()">–¢–µ—Å—Ç Supabase</button>
        <button onclick="testAll()">–¢–µ—Å—Ç –≤—Å–µ–≥–æ</button>
    </div>

    <div id="results"></div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
        async function checkServerStatus() {
            try {
                const response = await fetch('/');
                if (response.ok) {
                    document.getElementById('server-status').innerHTML = 
                        '‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å—Ç–∞—Ç—É—Å: ' + response.status + ')';
                } else {
                    document.getElementById('server-status').innerHTML = 
                        '‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–æ —Å –æ—à–∏–±–∫–æ–π (—Å—Ç–∞—Ç—É—Å: ' + response.status + ')';
                }
            } catch (error) {
                document.getElementById('server-status').innerHTML = 
                    '‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ' + error.message;
            }
        }

        // –¢–µ—Å—Ç –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        async function testMainSite() {
            addResult('üîÑ –¢–µ—Å—Ç–∏—Ä—É—é –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É...', 'info');
            try {
                const response = await fetch('/');
                const html = await response.text();
                if (html.includes('WeShow') || html.includes('React')) {
                    addResult('‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                } else {
                    addResult('‚ö†Ô∏è –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π', 'warning');
                }
            } catch (error) {
                addResult('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ' + error.message, 'error');
            }
        }

        // –¢–µ—Å—Ç –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        async function testAdminPanel() {
            addResult('üîÑ –¢–µ—Å—Ç–∏—Ä—É—é –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å...', 'info');
            try {
                const response = await fetch('/admin');
                if (response.ok) {
                    addResult('‚úÖ –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞', 'success');
                } else {
                    addResult('‚ö†Ô∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (—Å—Ç–∞—Ç—É—Å: ' + response.status + ')', 'warning');
                }
            } catch (error) {
                addResult('‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏: ' + error.message, 'error');
            }
        }

        // –¢–µ—Å—Ç Supabase
        async function testSupabase() {
            addResult('üîÑ –¢–µ—Å—Ç–∏—Ä—É—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase...', 'info');
            try {
                const response = await fetch('https://zbykhdjqrtqftfitbvbt.supabase.co/rest/v1/', {
                    headers: {
                        'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpieWtoZGpxcnRxZnRmaXRidmJ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxMzkzMjMsImV4cCI6MjA3NDcxNTMyM30.L9M4qQ_gkoyLj7oOwKZgyOVHoGv4JMJw-8m91IJAZjE'
                    }
                });
                if (response.ok) {
                    addResult('‚úÖ Supabase –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                } else {
                    addResult('‚ö†Ô∏è Supabase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—Å—Ç–∞—Ç—É—Å: ' + response.status + ')', 'warning');
                }
            } catch (error) {
                addResult('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase: ' + error.message, 'error');
            }
        }

        // –¢–µ—Å—Ç –≤—Å–µ–≥–æ
        async function testAll() {
            clearResults();
            await checkServerStatus();
            await testMainSite();
            await testAdminPanel();
            await testSupabase();
        }

        // –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function addResult(message, type) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = 'status ' + type;
            div.innerHTML = '<p>' + message + '</p>';
            results.appendChild(div);
        }

        // –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            checkServerStatus();
        };
    </script>
</body>
</html>