<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ Canvas</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        canvas {
            border: 2px solid #333;
            background: #87CEEB;
            display: block;
            margin: 20px auto;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            margin: 10px;
            display: inline-block;
        }
        .info {
            margin: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <h1>üéÆ –¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ Canvas</h1>
    
    <div class="info">
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é Canvas</p>
        <p>–ï—Å–ª–∏ –∞–Ω–∏–º–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–¥–µ—Å—å, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ React - –ø—Ä–æ–±–ª–µ–º–∞ –≤ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ</p>
    </div>
    
    <button onclick="startAnimation()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é</button>
    <button onclick="stopAnimation()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é</button>
    <button onclick="testJump()">–¢–µ—Å—Ç –ø—Ä—ã–∂–∫–∞</button>
    
    <canvas id="testCanvas" width="800" height="400"></canvas>
    
    <div class="status">
        <div id="status">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–Ω–∏–µ...</div>
        <div id="fps">FPS: 0</div>
        <div id="frameCount">–ö–∞–¥—Ä—ã: 0</div>
    </div>

    <script>
        const canvas = document.getElementById('testCanvas');
        const ctx = canvas.getContext('2d');
        const statusDiv = document.getElementById('status');
        const fpsDiv = document.getElementById('fps');
        const frameCountDiv = document.getElementById('frameCount');
        
        let animationId = null;
        let frameCount = 0;
        let lastTime = 0;
        let isAnimating = false;
        
        let bikeY = 350;
        let isJumping = false;
        let jumpStart = 0;
        
        let obstacles = [];
        let score = 0;
        let timeLeft = 30;
        
        function drawBackground() {
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 800, 400);
        }
        
        function drawGround() {
            ctx.fillStyle = '#8FBC8F';
            ctx.fillRect(0, 350, 800, 50);
        }
        
        function drawBike(x, y) {
            ctx.strokeStyle = '#E74C3C';
            ctx.lineWidth = 4;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + 40, y);
            ctx.lineTo(x + 20, y - 20);
            ctx.lineTo(x, y);
            ctx.stroke();
            
            ctx.strokeStyle = '#2C3E50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x + 10, y, 8, 0, Math.PI * 2);
            ctx.arc(x + 30, y, 8, 0, Math.PI * 2);
            ctx.stroke();
        }
        
        function drawObstacle(obstacle) {
            ctx.fillStyle = '#FF6B6B';
            ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(obstacle.type, obstacle.x + 5, obstacle.y + 20);
        }
        
        function drawUI() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(10, 10, 200, 100);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '16px Arial';
            ctx.fillText(`–û—á–∫–∏: ${score}`, 20, 30);
            ctx.fillStyle = '#FFD700';
            ctx.fillText(`–í—Ä–µ–º—è: ${timeLeft}s`, 20, 50);
            ctx.fillStyle = '#00FF00';
            ctx.fillText(`FPS: ${Math.round(1000 / (Date.now() - lastTime))}`, 20, 70);
            ctx.fillStyle = '#FF69B4';
            ctx.fillText(`–ö–∞–¥—Ä—ã: ${frameCount}`, 20, 90);
        }
        
        function updateObstacles() {
            obstacles = obstacles
                .map(obstacle => ({
                    ...obstacle,
                    x: obstacle.x - 3
                }))
                .filter(obstacle => obstacle.x > -obstacle.width);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
            if (Math.random() < 0.02) {
                const types = ['projector', 'touchpanel', 'computer', 'speaker', 'camera'];
                const type = types[Math.floor(Math.random() * types.length)];
                
                obstacles.push({
                    id: Date.now(),
                    x: 800,
                    y: 310,
                    width: 40,
                    height: 40,
                    type: type
                });
            }
        }
        
        function updateJump() {
            if (isJumping) {
                const elapsed = Date.now() - jumpStart;
                const progress = Math.min(elapsed / 500, 1);
                
                const jumpHeight = 80 * Math.sin(progress * Math.PI);
                bikeY = 350 - jumpHeight;
                
                if (progress >= 1) {
                    isJumping = false;
                    bikeY = 350;
                }
            }
        }
        
        function gameLoop(currentTime) {
            if (!isAnimating) return;
            
            frameCount++;
            
            // –û—á–∏—Å—Ç–∫–∞ canvas
            ctx.clearRect(0, 0, 800, 400);
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
            drawBackground();
            drawGround();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            updateObstacles();
            obstacles.forEach(drawObstacle);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
            updateJump();
            drawBike(100, bikeY);
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ UI
            drawUI();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FPS
            if (lastTime > 0) {
                const fps = 1000 / (currentTime - lastTime);
                fpsDiv.textContent = `FPS: ${Math.round(fps)}`;
            }
            lastTime = currentTime;
            
            frameCountDiv.textContent = `–ö–∞–¥—Ä—ã: ${frameCount}`;
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç–∞
            score++;
            
            // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            animationId = requestAnimationFrame(gameLoop);
        }
        
        function startAnimation() {
            if (isAnimating) return;
            
            isAnimating = true;
            frameCount = 0;
            score = 0;
            obstacles = [];
            bikeY = 350;
            isJumping = false;
            
            statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞!';
            statusDiv.style.color = '#00FF00';
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            animationId = requestAnimationFrame(gameLoop);
            
            // –¢–∞–π–º–µ—Ä
            const timer = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    stopAnimation();
                    statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –í—Ä–µ–º—è –≤—ã—à–ª–æ!';
                    statusDiv.style.color = '#FF0000';
                }
            }, 1000);
        }
        
        function stopAnimation() {
            isAnimating = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            
            statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –ê–Ω–∏–º–∞—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞';
            statusDiv.style.color = '#FFA500';
        }
        
        function testJump() {
            if (!isAnimating) return;
            
            if (!isJumping) {
                isJumping = true;
                jumpStart = Date.now();
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ Canvas
        canvas.addEventListener('click', testJump);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à
        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space') {
                event.preventDefault();
                testJump();
            }
        });
        
        // –ù–∞—á–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
        drawBackground();
        drawGround();
        drawBike(100, 350);
        
        statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é';
        statusDiv.style.color = '#FFFFFF';
    </script>
</body>
</html>
