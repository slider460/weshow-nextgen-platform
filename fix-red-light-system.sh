#!/bin/bash

echo "üî¥ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∞—Å–Ω–æ–≥–æ —Å–≤–µ—Ç–∞ MCP Context7 —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º..."
echo ""

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä—ã..."
pkill -f "mcp-context7-server" 2>/dev/null || true
pkill -f "mcp-system-server" 2>/dev/null || true
sleep 2

echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
echo "üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Context7 —Å–µ—Ä–≤–µ—Ä–∞..."
export PATH="$PWD/node-v22.12.0-darwin-arm64/bin:$PATH"
node src/lib/mcp-system-server.js > system-server.log 2>&1 &
SYSTEM_PID=$!
echo "‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω —Å PID: $SYSTEM_PID"

echo ""

# –ñ–¥—ë–º –∑–∞–ø—É—Å–∫–∞
echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞..."
sleep 5

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞..."
if curl -s http://localhost:3004/status > /dev/null 2>&1; then
    echo "‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3004"
else
    echo "‚ùå –°–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç"
    exit 1
fi

echo ""

# –¢–µ—Å—Ç–∏—Ä—É–µ–º MCP endpoint
echo "üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MCP endpoint..."
MCP_RESPONSE=$(curl -s -X POST http://localhost:3004/mcp \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","id":1,"method":"tools/list"}')

if [ $? -eq 0 ]; then
    echo "‚úÖ MCP endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
    echo "üìù –î–æ—Å—Ç—É–ø–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: $(echo $MCP_RESPONSE | grep -o '"name"' | wc -l)"
else
    echo "‚ùå MCP endpoint –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç"
    exit 1
fi

echo ""

# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo "üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—É—é MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é..."
./switch-mcp.sh system

echo ""

echo "üéØ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫—Ä–∞—Å–Ω–æ–≥–æ —Å–≤–µ—Ç–∞:"
echo ""
echo "1. üîÑ –ü–ï–†–ï–ó–ê–ü–£–°–¢–ò–¢–ï Cursor IDE –ø–æ–ª–Ω–æ—Å—Ç—å—é"
echo "   - –ó–∞–∫—Ä–æ–π—Ç–µ Cursor IDE"
echo "   - –û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–Ω–æ–≤–æ"
echo ""
echo "2. üìç –û—Ç–∫—Ä–æ–π—Ç–µ MCP –ø–∞–Ω–µ–ª—å –≤ Cursor IDE:"
echo "   - View ‚Üí Command Palette (Cmd+Shift+P)"
echo "   - –í–≤–µ–¥–∏—Ç–µ: 'MCP: Show Servers'"
echo "   - –ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ MCP –ø–∞–Ω–µ–ª—å –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏"
echo ""
echo "3. üü¢ Context7 –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –∑–µ–ª—ë–Ω—ã–π —Å–≤–µ—Ç"
echo "   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞–Ω–µ—Ç –∑–µ–ª—ë–Ω—ã–º"
echo "   - –ü–æ—è–≤–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤"
echo "   - –°—Ç–∞—Ç—É—Å 'No tools or prompts' –∏—Å—á–µ–∑–Ω–µ—Ç"
echo ""
echo "4. üîß –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –∫—Ä–∞—Å–Ω—ã–π:"
echo "   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: tail -f system-server.log"
echo "   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 3004 —Å–≤–æ–±–æ–¥–µ–Ω"
echo "   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç –≤ mcp-system-server.js"
echo ""
echo "‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!"
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Cursor IDE –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ MCP –ø–∞–Ω–µ–ª—å!"





