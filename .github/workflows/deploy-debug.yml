name: üîç Debug Vercel Deployment

on:
  workflow_dispatch: # –¢–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v4
        
      - name: üì¶ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: üìö Install dependencies
        run: npm ci
        
      - name: üî® Build project
        run: npm run build
        
      - name: üîç Check build output
        run: |
          echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ dist/:"
          ls -la dist/
          echo "üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º index.html:"
          head -20 dist/index.html
          
      - name: üîë Check Vercel secrets
        run: |
          echo "üîë –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–∫—Ä–µ—Ç—ã Vercel:"
          if [ -n "${{ secrets.VERCEL_TOKEN }}" ]; then
            echo "‚úÖ VERCEL_TOKEN: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–¥–ª–∏–Ω–∞: ${#VERCEL_TOKEN})"
          else
            echo "‚ùå VERCEL_TOKEN: –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"
          fi
          
          if [ -n "${{ secrets.VERCEL_ORG_ID }}" ]; then
            echo "‚úÖ VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}"
          else
            echo "‚ùå VERCEL_ORG_ID: –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"
          fi
          
          if [ -n "${{ secrets.VERCEL_PROJECT_ID }}" ]; then
            echo "‚úÖ VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}"
          else
            echo "‚ùå VERCEL_PROJECT_ID: –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"
          fi
          
      - name: üöÄ Test Vercel deployment
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'
        continue-on-error: true
        
      - name: üìä Final status
        run: |
          echo "üìä –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:"
          if [ ${{ job.status }} == 'success' ]; then
            echo "‚úÖ –£–°–ü–ï–•! –°–∞–π—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç"
          else
            echo "‚ùå –û–®–ò–ë–ö–ê! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ"
          fi
